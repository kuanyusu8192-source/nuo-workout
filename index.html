<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NUOå¥èº«ç´€éŒ„</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#34495e">
    <style>
        :root {
            --primary: #3498db; /* æ‰å¹³è— */
            --secondary: #2ecc71; /* æ‰å¹³ç¶  */
            --accent: #e74c3c; /* æ‰å¹³ç´… */
            --dark: #2c3e50;
            --light: #ecf0f1;
            --grey: #95a5a6;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--light);
            color: var(--dark);
            margin: 0;
            padding: 0;
            padding-bottom: 80px; /* åº•éƒ¨ç©ºé–“ */
        }
        header {
            background-color: var(--dark);
            color: white;
            padding: 15px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h1 { margin: 0; font-size: 1.2rem; font-weight: 500; }
        
        /* æ˜ŸæœŸé¸æ“‡å™¨ */
        .day-selector {
            display: flex;
            overflow-x: auto;
            background: white;
            padding: 10px;
            gap: 10px;
            scrollbar-width: none;
        }
        .day-btn {
            background: var(--light);
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: var(--grey);
            white-space: nowrap;
            cursor: pointer;
            transition: 0.2s;
        }
        .day-btn.active {
            background: var(--primary);
            color: white;
        }

        /* å‹•ä½œå¡ç‰‡ */
        .container { padding: 15px; }
        .card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 0 rgba(0,0,0,0.05);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .exercise-name { font-size: 1.1rem; font-weight: bold; color: var(--dark); }
        .muscle-tag {
            background: var(--light);
            color: var(--grey);
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 4px;
        }
        .desc-text { font-size: 0.9rem; color: #666; margin-bottom: 10px; line-height: 1.4; }
        
        /* è¼¸å…¥å€åŸŸ */
        .log-area {
            background: #f9f9f9;
            padding: 10px;
            border-radius: 6px;
        }
        .input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 8px;
            align-items: center;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            text-align: center;
        }
        .btn-log {
            background: var(--secondary);
            color: white;
            border: none;
            width: 100%;
            padding: 10px;
            border-radius: 4px;
            font-size: 1rem;
            margin-top: 5px;
            cursor: pointer;
        }
        
        /* è¨“ç·´é‡é¡¯ç¤º */
        .volume-display {
            margin-top: 8px;
            font-size: 0.85rem;
            color: var(--primary);
            text-align: right;
            font-weight: bold;
        }

        /* åº•éƒ¨æ”¶æ“æŒ‰éˆ• */
        .cooldown-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--accent);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(231, 76, 60, 0.4);
            z-index: 200;
            cursor: pointer;
        }

        /* æ¨¡æ…‹æ¡† (æ”¶æ“) */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-height: 70vh;
            overflow-y: auto;
        }
        .close-btn {
            float: right;
            font-size: 1.5rem;
            cursor: pointer;
        }
    </style>
</head>
<body>

<header>
    <h1>NUO232 å±…å®¶è¨“ç·´</h1>
</header>

<div class="day-selector" id="daySelector">
    <!-- JSç”Ÿæˆæ˜ŸæœŸæŒ‰éˆ• -->
</div>

<div class="container" id="workoutContainer">
    <!-- JSç”Ÿæˆè¨“ç·´å¡ç‰‡ -->
</div>

<button class="cooldown-btn" onclick="openCooldown()">ğŸ§˜ æ”¶æ“å»ºè­°</button>

<!-- æ”¶æ“è¦–çª— -->
<div id="cooldownModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeCooldown()">&times;</span>
        <h2>ä»Šæ—¥æ”¶æ“</h2>
        <div id="cooldownText"></div>
    </div>
</div>

<script>
    // 1. è¨“ç·´è³‡æ–™åº«
    const workouts = {
        0: { name: "é€±æ—¥", focus: "ä¼‘æ¯æ—¥", exercises: [], cooldown: "ä»Šå¤©è«‹å¥½å¥½ä¼‘æ¯ï¼Œåšé»è¼•åº¦ä¼¸å±•å³å¯ã€‚" },
        1: { name: "é€±ä¸€", focus: "æ¨ (èƒ¸/è‚©/ä¸‰é ­)", 
            exercises: [
                {id: "m1", name: "å•éˆ´è‡¥æ¨", muscle: "èƒ¸å¤§è‚Œ", desc: "èƒŒéƒ¨è²¼ç·Šè‡¥æ¨æ¤…ï¼Œé›™è…³è¸©å¯¦ï¼Œæ‰‹è‚˜èˆ‡èº«é«”å‘ˆ45åº¦ä¸‹æ”¾ã€‚"},
                {id: "m2", name: "ä¸Šæ–œå•éˆ´è‡¥æ¨", muscle: "ä¸Šèƒ¸", desc: "æ¤…èƒŒèª¿æ•´è‡³30-45åº¦ï¼Œå°ˆæ³¨ä¸Šèƒ¸æ”¶ç¸®ã€‚"},
                {id: "m3", name: "åå§¿å•éˆ´è‚©æ¨", muscle: "ä¸‰è§’è‚Œå‰/ä¸­æŸ", desc: "æ¤…èƒŒèª¿ç›´ï¼Œæ ¸å¿ƒæ”¶ç·Šï¼Œæ¨èˆ‰éé ­ã€‚"},
                {id: "m4", name: "å•éˆ´å´å¹³èˆ‰", muscle: "ä¸‰è§’è‚Œä¸­æŸ", desc: "æ‰‹è‚˜å¾®å½ï¼Œåƒå€’æ°´ä¸€æ¨£å°‡å•éˆ´å‘å…©å´èˆ‰èµ·ã€‚"},
                {id: "m5", name: "éé ‚ä¸‰é ­å±ˆä¼¸", muscle: "ä¸‰é ­è‚Œ", desc: "é›™æ‰‹æŒä¸€é¡†å•éˆ´æ–¼è…¦å¾Œï¼Œä¿æŒå¤§è‡‚ç©©å®šï¼Œåƒ…ç§»å‹•å°è‡‚ã€‚"}
            ],
            cooldown: "1. èƒ¸è‚Œæ‹‰ä¼¸ (æ‰¾é–€æ¡†) 30ç§’<br>2. è‚©è†€å¾Œå´æ‹‰ä¼¸ 30ç§’<br>3. ä¸‰é ­è‚Œæ‹‰ä¼¸ 30ç§’"
        },
        2: { name: "é€±äºŒ", focus: "æ‹‰ (èƒŒ/å¾Œè‚©/äºŒé ­)", 
            exercises: [
                {id: "t1", name: "å–®è‡‚å•éˆ´åˆ’èˆ¹", muscle: "èƒŒé—Šè‚Œ", desc: "å–®æ‰‹å–®è†è·ªåœ¨è‡¥æ¨æ¤…ä¸Šï¼ŒèƒŒéƒ¨æŒºç›´ï¼Œå°‡å•éˆ´æ‹‰å‘é«–éƒ¨ã€‚"},
                {id: "t2", name: "é›™æ‰‹å•éˆ´åˆ’èˆ¹", muscle: "ä¸ŠèƒŒ", desc: "ä¿¯èº«ï¼Œæ ¸å¿ƒæ”¶ç·Šï¼Œå‘å¾Œå¤¾èƒŒã€‚"},
                {id: "t3", name: "å•éˆ´åå‘é£›é³¥", muscle: "å¾Œä¸‰è§’è‚Œ", desc: "ä¿¯èº«ï¼Œæ‰‹è‡‚å‘å…©å´æ‰“é–‹ï¼Œæ„Ÿå—å¾Œè‚©ç™¼åŠ›ã€‚"},
                {id: "t4", name: "ç«™å§¿å•éˆ´å½èˆ‰", muscle: "äºŒé ­è‚Œ", desc: "æŒå¿ƒå‘å‰ï¼Œä¿æŒå¤§è‡‚è²¼ç·Šèº«é«”ã€‚"},
                {id: "t5", name: "å‚å¼å½èˆ‰", muscle: "äºŒé ­/å‰è‡‚", desc: "æŒå¿ƒç›¸å° (åƒæ‹¿éµéš)ï¼Œè¨“ç·´è‚±è‚Œã€‚"}
            ],
            cooldown: "1. å¬°å…’å¼ (ç‘œçˆ) 1åˆ†é˜<br>2. èƒŒé—Šè‚Œå´å‘ä¼¸å±• 30ç§’<br>3. æ‰‹è‡‚äºŒé ­è‚Œä¼¸å±• 30ç§’"
        },
        3: { name: "é€±ä¸‰", focus: "è…¿ (è‚¡å››/å¾Œè…¿)", 
            exercises: [
                {id: "w1", name: "é«˜è…³æ¯æ·±è¹²", muscle: "è‚¡å››é ­/æ ¸å¿ƒ", desc: "é›™æ‰‹æ§è‘—ä¸€é¡†å•éˆ´åœ¨èƒ¸å‰ï¼ŒèƒŒæŒºç›´ä¸‹è¹²ï¼Œå¤§è…¿å¹³è¡Œåœ°é¢ã€‚"},
                {id: "w2", name: "å•éˆ´åˆ†è…¿è¹² (Lunges)", muscle: "å–®è…¿/è‡€", desc: "é›™æ‰‹æŒå•éˆ´ï¼Œäº¤æ›¿è·¨æ­¥ä¸‹è¹²ï¼Œè†è“‹ä¸è§¸åœ°ã€‚"},
                {id: "w3", name: "ç¾…é¦¬å°¼äºç¡¬èˆ‰ (RDL)", muscle: "è…¿å¾Œ/è‡€", desc: "å¾®å±ˆè†ï¼Œå±è‚¡å‘å¾Œæ¨ï¼Œå•éˆ´æ²¿è‘—è…¿éƒ¨ä¸‹æ”¾è‡³è„›éª¨ä¸­æ®µã€‚"},
                {id: "w4", name: "åå§¿æè¸µ", muscle: "å°è…¿", desc: "åå§¿ï¼Œå°‡å•éˆ´ç½®æ–¼è†è“‹ä¸Šï¼Œå¢Šè…³å°–ã€‚"}
            ],
            cooldown: "1. è‚¡å››é ­è‚Œæ‹‰ä¼¸ (å–®è…³ç«™ç«‹) 30ç§’<br>2. è…¿å¾Œå´æ‹‰ä¼¸ (åå§¿é«”å‰å½) 30ç§’<br>3. è‡€éƒ¨æ‹‰ä¼¸ (é´¿å¼) 30ç§’"
        },
        4: { name: "é€±å››", focus: "ä¸»å‹•æ¢å¾©", exercises: [], cooldown: "é€²è¡Œ 20 åˆ†é˜å¿«èµ°æˆ–ç‘œçˆï¼Œæ”¾é¬†ç·Šç¹ƒè‚Œè‚‰ã€‚" },
        5: { name: "é€±äº”", focus: "ä¸Šè‚¢ç¶œåˆ", 
            exercises: [
                {id: "f1", name: "å¹³åœ°å•éˆ´é£›é³¥", muscle: "èƒ¸", desc: "æ‰‹è‡‚å¾®å½ï¼Œæ„Ÿå—èƒ¸è‚Œæ‹‰é•·èˆ‡æ”¶ç¸®ã€‚"},
                {id: "f2", name: "é˜¿è«¾è‚©æ¨", muscle: "è‚©", desc: "æ—‹è½‰æ¨èˆ‰ï¼Œåˆºæ¿€ä¸‰è§’è‚Œå‰ä¸­æŸã€‚"},
                {id: "f3", name: "é›†ä¸­å½èˆ‰", muscle: "äºŒé ­", desc: "åå§¿ï¼Œæ‰‹è‚˜æŠµä½å¤§è…¿å…§å´ã€‚"},
                {id: "f4", name: "æ¿å‡³æ’é«” (Dips)", muscle: "ä¸‰é ­", desc: "é›™æ‰‹æ’åœ¨è‡¥æ¨æ¤…é‚Šç·£ï¼Œèº«é«”ä¸‹æ²‰å†æ¨èµ·ã€‚"}
            ],
            cooldown: "1. å…¨èº«ä¸ŠåŠèº«ä¼¸å±•<br>2. é ¸éƒ¨æ”¾é¬†"
        },
        6: { name: "é€±å…­", focus: "ä¸‹è‚¢/æ ¸å¿ƒ", 
            exercises: [
                {id: "s1", name: "ç›¸æ’²æ·±è¹²", muscle: "å…§æ”¶è‚Œ/è‡€", desc: "é›™è…³å¯¬ç«™è·ï¼Œæ‰‹æŒå•éˆ´å‚ç›´ä¸‹è¹²ã€‚"},
                {id: "s2", name: "å–®è…¿ç¡¬èˆ‰", muscle: "è…¿å¾Œ/å¹³è¡¡", desc: "å–®è…³æ”¯æ’ï¼Œå¦ä¸€è…³å‘å¾Œå»¶ä¼¸ï¼Œèº«é«”å‰å‚¾ã€‚"},
                {id: "s3", name: "å•éˆ´ä¿„ç¾…æ–¯è½‰é«”", muscle: "è…¹æ–œè‚Œ", desc: "åå§¿æŠ¬è…¿ï¼ŒæŒå•éˆ´å·¦å³è½‰å‹•ã€‚"},
                {id: "s4", name: "è² é‡æ²è…¹", muscle: "è…¹è‚Œ", desc: "èººåœ¨ç‘œçˆå¢Šæˆ–æ¤…ä¸Šï¼Œèƒ¸å‰æŠ±å•éˆ´æ²è…¹ã€‚"}
            ],
            cooldown: "1. è…¿éƒ¨å…¨å¥—ä¼¸å±•<br>2. è…¹éƒ¨çœ¼é¡è›‡å¼ä¼¸å±•"
        }
    };

    // 2. åˆå§‹åŒ– App
    let currentDay = new Date().getDay(); // 0-6
    
    function init() {
        renderDaySelector();
        loadWorkout(currentDay);
    }

    // æ¸²æŸ“æ˜ŸæœŸé¸æ“‡å™¨
    function renderDaySelector() {
        const selector = document.getElementById('daySelector');
        const days = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];
        selector.innerHTML = days.map((d, index) => 
            `<button class="day-btn ${index === currentDay ? 'active' : ''}" onclick="changeDay(${index})">${d}</button>`
        ).join('');
    }

    // åˆ‡æ›æ—¥æœŸ
    window.changeDay = (dayIndex) => {
        currentDay = dayIndex;
        renderDaySelector();
        loadWorkout(dayIndex);
    }

    // è¼‰å…¥è¨“ç·´å…§å®¹
    function loadWorkout(dayIndex) {
        const container = document.getElementById('workoutContainer');
        const plan = workouts[dayIndex];
        
        if (plan.exercises.length === 0) {
            container.innerHTML = `<div class="card" style="text-align:center;"><h3>${plan.focus}</h3><p>å¥½å¥½äº«å—ä¼‘æ¯æ™‚å…‰ï¼</p></div>`;
            return;
        }

        container.innerHTML = plan.exercises.map(ex => {
            // è®€å–æ­·å²æ•¸æ“š (ä¸Šä¸€æ¬¡çš„ç´€éŒ„)
            const lastLog = JSON.parse(localStorage.getItem(`nuo_${ex.id}`)) || {w: 0, r: 0, v: 0};
            
            return `
            <div class="card">
                <div class="card-header">
                    <span class="exercise-name">${ex.name}</span>
                    <span class="muscle-tag">${ex.muscle}</span>
                </div>
                <div class="desc-text">${ex.desc}</div>
                <div class="log-area">
                    <div style="font-size:0.8rem; color:#888; margin-bottom:5px;">ä¸Šæ¬¡ç´€éŒ„: ${lastLog.w}kg x ${lastLog.r}æ¬¡</div>
                    <div class="input-row">
                        <input type="number" placeholder="é‡é‡(kg)" id="w_${ex.id}" value="${lastLog.w > 0 ? lastLog.w : ''}">
                        <input type="number" placeholder="æ¬¡æ•¸" id="r_${ex.id}">
                        <input type="number" placeholder="çµ„æ•¸" id="s_${ex.id}" value="3">
                    </div>
                    <button class="btn-log" onclick="saveLog('${ex.id}')">ç´€éŒ„é€™çµ„ & è¨ˆç®—ç¸½é‡</button>
                    <div class="volume-display" id="v_${ex.id}">ä»Šæ—¥è¨“ç·´é‡: 0 kg</div>
                </div>
            </div>`;
        }).join('');
    }

    // å„²å­˜ç´€éŒ„é‚è¼¯
    window.saveLog = (id) => {
        const w = parseFloat(document.getElementById(`w_${id}`).value) || 0;
        const r = parseFloat(document.getElementById(`r_${id}`).value) || 0;
        const s = parseFloat(document.getElementById(`s_${id}`).value) || 0;
        
        const volume = w * r * s;
        
        // é¡¯ç¤ºè¨“ç·´é‡
        document.getElementById(`v_${id}`).innerText = `ç¸½è¨“ç·´é‡ (Volume): ${volume} kg`;

        // å„²å­˜åˆ° LocalStorage
        const logData = { w: w, r: r, s: s, date: new Date().toISOString() };
        localStorage.setItem(`nuo_${id}`, JSON.stringify(logData));
        
        alert(`å·²ç´€éŒ„: ${w}kg x ${r}æ¬¡ x ${s}çµ„`);
    }

    // æ”¶æ“æ¨¡æ…‹æ¡†æ§åˆ¶
    window.openCooldown = () => {
        const modal = document.getElementById('cooldownModal');
        const text = document.getElementById('cooldownText');
        text.innerHTML = workouts[currentDay].cooldown;
        modal.style.display = "flex";
    }
    window.closeCooldown = () => {
        document.getElementById('cooldownModal').style.display = "none";
    }

    // è¨»å†Š Service Worker (PWAæ ¸å¿ƒ)
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js')
            .then(() => console.log('Service Worker Registered'));
    }

    init();
</script>

</body>
</html>